<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11-strict.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name='robots' content='noindex,nofollow'/>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <title>Authentication and BibORB</title>
</head>

<body>

<div id="main_container">
<div id="main">
<h1>Authentication and BibORB</h1>      
    <p>Configure the authentication support in <acronym class='biborb'>BibORB</acronym> 1.3.2.</p>

<div id="index">
    <h3>Index</h3>
    <ul>
        <li><a href="#help_intro">Introduction</a></li>
        <li><a href="#help_htaccess">.htaccess</a></li>
        <li><a href="#help_mysql">MySQL</a></li>
        <li><a href="#help_file">File</a></li>
    </ul>
</div>

<div id="content">

<div class="topic" id="help_intro">
    <h3>Introduction</h3>
    <div class="topic_content">
    <p>If BibORB is used in a collaborative way, you will want to define who can add, modify or delete references. Presently, two authentication methods are supported: MySQL and files.</p>
    </div>
</div>

<div class="topic" id="help_htaccess">
    <h3>Access restriction using <code>.htaccess</code></h3>
    <div class="topic_content">
    <p>You can use <code class='file'>.htaccess</code> to restrict the access to BibORB. Create a new <code class='file'>.htpasswd</code> file and uncomment the authentication section in <code class='file'>.htaccess</code></p>
    <pre>AuthName BibORB Restricted Area
AuthType Basic
AuthUserFile /path/to/htpasswd
require valid-user</pre>
    </div>
</div>

<div class="topic" id="help_mysql">
    <h3>MySQL authentication</h3>
    <div class="topic_content">
    <p>Values to defined in <code class='file'>config.php</code>:</p>
    <pre>/**
 * If TRUE, this will disable authentification.
 * All users will have the administrator status
 */
$disable_authentication = FALSE;

/**
 * Authentication methods: mysql, files
 * Used if $disable_authentication = FALSE
 */
$authentication_method = 'mysql';</pre>
    <p>The next step is to correctly set up <code class='file'>php/auth_backends/auth.mysql.php</code>. This is done by defining:</p>
<pre>
/**
    The database configuration
*/
$host = "localhost";
$db = "biborb";
$dbuser = "biborb-admin";
$pass = "biborbdev";
$table = "biborb_users";
$auth_table = "biborb_auth";</pre>
    <ul>
        <li><code class='variable'>$host</code>: address of the machine hosting the database.</li>
        <li><code class='variable'>$db</code>: name of the database.</li>
        <li><code class='variable'>$dbuser</code>: a valid MySQL user which has access to the database.</li>
        <li><code class='variable'>$pass</code>: its password.</li>
        <li><code class='variable'>$table</code>: the table containing valid biborb users and passwords.</li>
        <li><code class='variable'>$auth_table</code>: the table that defined authorizations for biborb users.</li>
    </ul>
    
    <p><code class='file'>data/biborb.sql</code> contains the SQL structure used with the MySQL authentication. Have a look to <code class='file'>php/auth_backends/auth.mysql.php</code> for details about the structure of the database.</p>
    </div>
</div>

<div class="topic" id="help_file">
    <h3>Files authentication</h3>
    <div class="topic_content">
    <p>If you don't want or don't have access to a database, you can configure authorizations using files.</p>
    <p>Values to defined in <code class='file'>config.php</code>:</p>
        <pre>/**
 * If TRUE, this will disable authentification.
 * All users will have the administrator status
 */
$disable_authentication = FALSE;

/**
 * Authentication methods: mysql, files
 * Used if $disable_authentication = FALSE
 */
$authentication_method = 'files';</pre>
    <p>Files used to defines access are <code class='file'>php/auth_backends/bib_access.txt</code> and <code class='file'>php/auth_backends/bib_users.txt</code></p>
    <ul>
        <li><code class='file'>php/auth_backends/bib_users.txt</code>: it contains a list of user/password: <code>user:crypted_password,isAdmin</code> where <code>isAdmin=1</code> if the user is an administrator (all privileges, add/delete bibliographies), 0 otherwise.
<pre>
testuser:testpass,0
admin:admin,1
</pre>
Use <code class='file'>php/auth_backends/crypt_password.txt</code> to crypt your password.
        </li>
        <li><code class='file'>php/auth_backends/bib_access.txt</code>: it defines the users' privileges on each database (<code>a</code>: add reference, <code>d</code>: delete reference, <code>m</code>: update reference)
<pre>
abibliography:testuser*m,anotheruser*adm
anotherbiblio:testuser*adm,anotheruser*am
</pre>
        </li>
    </ul>
    </div>
</div>
</div>
</div>
</div>
</body>
</html>
